<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>ğŸ’– ä¸“å±ç‚¹é¤æœºï¼šä»Šå¤©åƒä»€ä¹ˆï¼Ÿ</title>
    <style>
        /* --- 1. é¡µé¢æ•´ä½“å¸ƒå±€ --- */
        body {
            font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
            background-color: #fce4ec;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            color: #333;
            overflow: hidden; /* é˜²æ­¢å› ä¸ºè®¾ç½®å¼¹çª—å‡ºç°æ»šåŠ¨æ¡ */
        }

        h1 {
            margin-bottom: 20px;
            color: #d81b60;
            font-size: 22px;
            text-align: center;
            line-height: 1.4;
            padding: 0 20px;
        }

        /* --- 2. è€è™æœºä¸»ä½“çª—å£ --- */
        .slot-machine {
            position: relative;
            width: 300px;
            height: 120px;
            background: #fff;
            border-radius: 15px;
            border: 4px solid #d81b60;
            overflow: hidden;
            box-shadow: 0 10px 20px rgba(0,0,0,0.15);
            margin-bottom: 20px;
        }

        .slot-machine::before {
            content: "";
            position: absolute;
            top: 50%; left: 0; width: 100%; height: 2px;
            background: rgba(216, 27, 96, 0.2);
            z-index: 10;
            transform: translateY(-50%);
        }
        
        .slot-machine::after {
            content: "â—€";
            position: absolute;
            top: 50%; right: 10px;
            color: #d81b60;
            transform: translateY(-50%);
            z-index: 10;
        }

        /* --- 3. æ»šåŠ¨çš„é•¿åˆ—è¡¨ --- */
        .reel {
            list-style: none;
            padding: 0; margin: 0;
            transform: translateY(0); 
            transition: transform 3s cubic-bezier(0.1, 0.7, 0.1, 1); 
        }

        .item {
            height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 26px; /* ç¨å¾®è°ƒå°ä¸€ç‚¹é˜²æ­¢åå­—å¤ªé•¿æ¢è¡Œ */
            font-weight: bold;
            color: #444;
            border-bottom: 1px solid #eee;
            box-sizing: border-box;
            padding: 0 10px;
            text-align: center;
        }

        /* --- 4. æŒ‰é’®æ ·å¼ --- */
        .main-btn {
            padding: 15px 40px;
            font-size: 20px;
            border: none;
            border-radius: 50px;
            background-color: #d81b60;
            color: white;
            cursor: pointer;
            box-shadow: 0 4px #ad1457;
            transition: all 0.1s;
        }

        .main-btn:active {
            box-shadow: 0 0 #ad1457;
            transform: translateY(4px);
        }

        .main-btn:disabled {
            background-color: #ccc;
            box-shadow: none;
            cursor: not-allowed;
        }

        #result {
            margin-top: 10px;
            height: 30px;
            font-size: 18px;
            color: #d81b60;
            font-weight: bold;
            margin-bottom: 20px;
        }

        /* --- 5. è®¾ç½®é¢æ¿æ ·å¼ (æ–°å¢) --- */
        .settings-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(255,255,255,0.8);
            border: 1px solid #d81b60;
            color: #d81b60;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
            z-index: 100;
        }

        .settings-panel {
            display: none; /* é»˜è®¤éšè— */
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 200;
            justify-content: center;
            align-items: center;
        }

        .settings-box {
            background: #fff;
            padding: 20px;
            border-radius: 15px;
            width: 80%;
            max-width: 400px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .settings-box h3 {
            margin: 0 0 10px 0;
            color: #d81b60;
            text-align: center;
        }

        textarea {
            width: 100%;
            height: 150px;
            border: 2px solid #fce4ec;
            border-radius: 8px;
            padding: 10px;
            font-size: 16px;
            font-family: inherit;
            resize: none;
            box-sizing: border-box;
        }
        
        textarea:focus {
            outline: none;
            border-color: #d81b60;
        }

        .save-btn {
            background: #d81b60;
            color: white;
            border: none;
            padding: 10px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
        }
    </style>
</head>
<body>

    <h1>ğŸ‘‡ å¯çˆ±çš„æ ¼æ¦•å¦¹å¦¹ï¼Œä»Šå¤©åƒå“ªå®¶å‘¢ï¼Ÿ</h1>

    <div class="slot-machine">
        <div class="reel" id="reel">
            </div>
    </div>

    <div id="result"></div>

    <button class="main-btn" id="spin-btn" onclick="spin()">å¼€å§‹è§…é£Ÿï¼</button>

    <button class="settings-toggle" onclick="toggleSettings()">âš™ï¸ ä¿®æ”¹èœå•</button>

    <div class="settings-panel" id="settings-panel">
        <div class="settings-box">
            <h3>ğŸ“ ç¼–è¾‘é¤å…åˆ—è¡¨</h3>
            <p style="font-size:12px; color:#666; margin:0;">ä¸€è¡Œè¾“å…¥ä¸€ä¸ªé¤å…åå­—ï¼š</p>
            <textarea id="restaurant-input" placeholder="è¯·è¾“å…¥é¤å…ï¼Œä¸€è¡Œä¸€ä¸ª..."></textarea>
            <button class="save-btn" onclick="saveAndRefresh()">ä¿å­˜å¹¶æ›´æ–°</button>
            <button style="background:none; border:none; color:#999; margin-top:5px; cursor:pointer;" onclick="toggleSettings()">å–æ¶ˆ</button>
        </div>
    </div>

    <script>
        // é»˜è®¤æ•°æ®ï¼ˆç¬¬ä¸€æ¬¡æ‰“å¼€æ—¶æ˜¾ç¤ºï¼‰
        const defaultRestaurants = [
            "ğŸ èè‰äºš",
            "ğŸ å°åŠæ¢¨æ±¤",
            "ğŸ§‚ Black Salt",
            "ğŸ” å…‹æ¯”å”å”"
        ];

        let restaurants = [];
        const reel = document.getElementById('reel');
        const btn = document.getElementById('spin-btn');
        const resultText = document.getElementById('result');
        const itemHeight = 120; 

        // --- 1. åˆå§‹åŒ–é€»è¾‘ ---
        function init() {
            // å°è¯•ä»æœ¬åœ°å­˜å‚¨è¯»å–
            const savedData = localStorage.getItem('myDinnerList');
            if (savedData) {
                restaurants = JSON.parse(savedData);
            } else {
                restaurants = [...defaultRestaurants];
            }
            
            // æ¸²æŸ“æ»šè½®
            renderReel();
        }

        // --- 2. æ¸²æŸ“è€è™æœºåˆ—è¡¨ ---
        function renderReel() {
            let listHTML = "";
            // é‡å¤ 50 æ¬¡åˆ¶é€ æ— é™æ»šåŠ¨çš„è§†è§‰
            for (let i = 0; i < 50; i++) {
                restaurants.forEach(rest => {
                    listHTML += `<div class="item">${rest}</div>`;
                });
            }
            reel.innerHTML = listHTML;
            // é‡ç½®ä½ç½®
            reel.style.transition = 'none';
            reel.style.transform = 'translateY(0px)';
        }

        // --- 3. æŠ½å¥–é€»è¾‘ ---
        function spin() {
            if (restaurants.length === 0) {
                alert("èœå•æ˜¯ç©ºçš„ï¼Œå¿«å»è®¾ç½®é‡Œæ·»åŠ é¤å…å§ï¼");
                return;
            }

            btn.disabled = true;
            btn.innerText = "æ­£åœ¨é€‰æ‹©...";
            resultText.innerText = "";

            // æ¢å¤åŠ¨ç”»å±æ€§
            reel.style.transition = 'transform 3s cubic-bezier(0.1, 0.7, 0.1, 1)';

            const randomGroup = 20 + Math.floor(Math.random() * 20); 
            const randomItemIndex = Math.floor(Math.random() * restaurants.length);
            const finalIndex = (randomGroup * restaurants.length) + randomItemIndex;
            const newPosition = -(finalIndex * itemHeight);

            reel.style.transform = `translateY(${newPosition}px)`;

            setTimeout(() => {
                const winner = restaurants[randomItemIndex];
                resultText.innerText = "âœ¨ å°±å†³å®šæ˜¯ï¼š " + winner + " ï¼ âœ¨";
                btn.disabled = false;
                btn.innerText = "å¦¹å¦¹ä½ æ˜¯ä¸æ˜¯è¿˜æƒ³é‡æ‘‡å‘€ï¼Ÿ";
            }, 3000); 
        }

        // --- 4. è®¾ç½®é¢æ¿é€»è¾‘ ---
        const settingsPanel = document.getElementById('settings-panel');
        const textarea = document.getElementById('restaurant-input');

        function toggleSettings() {
            const isHidden = settingsPanel.style.display === 'none' || settingsPanel.style.display === '';
            if (isHidden) {
                // æ‰“å¼€æ—¶ï¼ŒæŠŠå½“å‰çš„é¤å…åˆ—è¡¨å¡«å…¥æ–‡æœ¬æ¡†
                textarea.value = restaurants.join('\n');
                settingsPanel.style.display = 'flex';
            } else {
                settingsPanel.style.display = 'none';
            }
        }

        function saveAndRefresh() {
            const text = textarea.value;
            // æŠŠæ–‡æœ¬è½¬æ¢æˆæ•°ç»„ï¼šæŒ‰æ¢è¡Œç¬¦åˆ†å‰² -> å»é™¤é¦–å°¾ç©ºæ ¼ -> å»é™¤ç©ºè¡Œ
            const newStats = text.split('\n').map(line => line.trim()).filter(line => line !== "");

            if (newStats.length < 2) {
                alert("è‡³å°‘è¾“å…¥ä¸¤ä¸ªé¤å…æ‰èƒ½ç©å“¦ï¼");
                return;
            }

            // æ›´æ–°å…¨å±€å˜é‡
            restaurants = newStats;
            // ä¿å­˜åˆ°æµè§ˆå™¨ç¼“å­˜
            localStorage.setItem('myDinnerList', JSON.stringify(restaurants));
            
            // é‡æ–°æ¸²æŸ“ç•Œé¢
            renderReel();
            settingsPanel.style.display = 'none';
            
            // é‡ç½®æŒ‰é’®æ–‡å­—
            btn.innerText = "å¼€å§‹è§…é£Ÿï¼";
            resultText.innerText = "èœå•å·²æ›´æ–° âœ…";
        }

        // å¯åŠ¨ï¼
        init();

    </script>
</body>
</html>
